---
title: 操作系统之死锁
date: 2021-05-03 20:43:12
tags:
- 计算机基础
- 操作系统
---

## 死锁产生的条件

- 互斥：一个临界资源只能同时被一个进程所占有
- 不可抢占：一个进程获取的资源只能由这个线程主动释放，不能被抢占
- 占有且等待：一个进程占有某些资源，并尝试去获取被其他进程占有的其他的资源
- 循环等待：进程等待形成环形等待链，每个进程都占有着上一个进程想要获取的资源，并且等待着下一个进程占有的资源

## 怎么处理死锁？

死锁的处理主要分为 **死锁的预防**，**死锁的避免**，以及**死锁的检测和解除**

##### 死锁的预防

> 死锁的预防是指破环死锁产生的四个必要条件的一个或多个

- 破坏不可抢占模式，一个进程申请被其他进程占有的资源时，要先释放自己手上的资源，这也可以认为是资源可以被抢占了
- 破坏占有且等待：系统在给进程分配资源时，直接把进程所需资源一次性分配给进程
- 破坏循环等待：将临界资源进行标记，进程进行资源的申请只能按照标记的某个方向进行申请

##### 死锁的避免

前置知识：系统安全状态，是指系统能按照某种进程推进顺序来为每个进程分配所需的资源，直至满足每个进程对资源的最大需求，如果系统无法找到这样的序列，那么就说系统处于不安全状态

而找出系统安全状态，是使用的银行家算法

##### 银行家算法

![image-20210404130747924](%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E6%AD%BB%E9%94%81/image-20210404130747924.png)

![image-20210404130812795](%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E6%AD%BB%E9%94%81/image-20210404130812795.png)

![image-20210404130827919](%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E6%AD%BB%E9%94%81/image-20210404130827919.png)

##### 死锁的检测

死锁的检测是指将系统资源和进程申请资源的关系画成 **资源分配图**，然后再进行资源分配图的简化，如果简化完成后资源分配图上还剩余线程，说明产生了死锁

**死锁的解除**

可以不使用死锁的预防和避免，允许死锁的产生，直到产生死锁后进行死锁的解除，主要方法又：

- 资源剥夺法：挂起死锁进程，并抢占它的资源，分配给其他死锁进程
- 撤销进程法：强制撤销部分或者是全部进程。
- 进程回退法：让一个或者多个